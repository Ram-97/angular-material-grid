<table mat-table [dataSource]="dataSource" [hidden]="dataSource.data.length === 0 || hidden" class="grid-container">
  <ng-container *ngFor="let column of columnMetaData" [matColumnDef]="column.name">
    <th mat-header-cell *matHeaderCellDef [style.width.px]="column?.width"
      [ngStyle]="{position: column?.separator ? 'relative' : ''}">
      {{column.title | translate}}
      <span *ngIf="column?.separator" class="separator">&nbsp;</span>
    </th>
    <td mat-cell *matCellDef="let element; let rowIndex = index">
      <ng-container *ngIf="!column?.isEditable || selectedRowIndex !== rowIndex; else controls">
        {{element[column.name]}}
      </ng-container>

      <ng-template #controls>
        <ng-container [ngSwitch]="column?.type" [formGroup]="editableColFormGrp">
          <mat-form-field appearance="outline" *ngSwitchCase="columnType.TEXT">
            <input matInput formControlName="{{column.name}}" required>
          </mat-form-field>
          <mat-form-field appearance="outline" *ngSwitchCase="columnType.NUMBER">
            <input matInput type="number" formControlName="{{column.name}}" (keypress)="omitSpecialChar($event);" required>
          </mat-form-field>
          <mat-form-field appearance="outline" *ngSwitchCase="columnType.DATE">
            <input matInput [matDatepicker]="picker" formControlName="{{column.name}}" readonly>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
          <mat-form-field appearance="outline" *ngSwitchDefault>
            <input matInput formControlName="{{column.name}}" required>
          </mat-form-field>
        </ng-container>
      </ng-template>
    </td>
  </ng-container>

  <ng-container matColumnDef="Action">
    <th mat-header-cell *matHeaderCellDef>
      Action
    </th>
    <td mat-cell *matCellDef="let element; let rowIndex = index">
      <!--Before Action-->
      <button mat-icon-button *ngFor="let action of beforeAction" (click)="onAction.emit(element)">
        <mat-icon [style.color]="action?.color ? action.color : '#808080'" class="icon-medium" [matTooltip]="action.toolTip"> {{action.iconName}} </mat-icon>
      </button>

      <button mat-icon-button *ngIf="isEdit && selectedRowIndex !== rowIndex; else editRow"
        (click)="rowOpen(rowIndex, element)">
        <mat-icon style="color:#808080;" class="icon-medium" matTooltip="Edit">edit</mat-icon>
      </button>

      <ng-template #editRow>
        <button mat-icon-button (click)="inlineDefaultActions(element);" [disabled]="!this.editableColFormGrp.valid" [ngClass]="{disable: !this.editableColFormGrp.valid}">
          <mat-icon style="color:#808080;" class="icon-medium" [ngClass]="{confirm:this.editableColFormGrp.valid}" matTooltip="Confirm">check</mat-icon>
        </button>
        <button mat-icon-button (click)="inlineDefaultActions(element,hasCancel);">
          <mat-icon style="color:#808080;" class="icon-medium" matTooltip="Cancel">close</mat-icon>
        </button>
      </ng-template>

      <!--InBetween Action-->
      <button mat-icon-button *ngFor="let action of inbetweenAction" (click)="onAction.emit(element)">
        <mat-icon [style.color]="action?.color ? action.color : '#808080'" class="icon-medium" [matTooltip]="action.toolTip"> {{action.iconName}} </mat-icon>
      </button>

      <button mat-icon-button *ngIf="isDelete && selectedRowIndex !== rowIndex" (click)="inlineDefaultActions(element);">
        <mat-icon style="color:#ff0000;" class="icon-medium" matTooltip="Delete">delete</mat-icon>
      </button>

      <!--After Action-->
      <button mat-icon-button *ngFor="let action of afterAction" (click)="onAction.emit(element)">
        <mat-icon [style.color]="action?.color ? action.color : '#808080'" class="icon-medium" [matTooltip]="action.toolTip"> {{action.iconName}} </mat-icon>
      </button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>